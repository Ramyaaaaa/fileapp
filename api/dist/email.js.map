{"version":3,"sources":["../src/email.js"],"names":["Email","app","post","callback","email","nodemailer","createTransport","service","auth","user","pass","from","_","get","to","message","postId","downloadLink","console","log","mailOptions","subject","text","html","sendMail","err","info"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;AAEA;;;;;;;;IACqBA,K;AAEjB,mBAAYC,GAAZ,EAAoB;AAAA;;AAChB,aAAKA,GAAL,GAAWA,GAAX;AAEH;;;;yCAGgBC,I,EAAsB;AAAA,gBAAhBC,QAAgB,uEAAP,YAAI,CAAE,CAAC;;;AAG3C;;AAEI,gBAAIC,QAAQC,qBAAWC,eAAX,CAA2B;AACvC;AACF;;AAEE;AACA;AACAC,yBAAS,OAN8B;;AAQvCC,sBAAM;;AAEJC,0BAAM,sBAFF,EAE0B;AAC9BC,0BAAM;;AAEJ;AACA;;AANE;AASN;;AAEA;AACA;AACA;AArBuC,aAA3B,CAAZ;;AAwBI;;AAEA,gBAAMC,OAAOC,iBAAEC,GAAF,CAAMX,IAAN,EAAW,MAAX,CAAb;AACA,gBAAMY,KAAKF,iBAAEC,GAAF,CAAMX,IAAN,EAAW,IAAX,CAAX;AACA,gBAAMa,UAAUH,iBAAEC,GAAF,CAAMX,IAAN,EAAW,SAAX,EAAsB,EAAtB,CAAhB;AACA,gBAAMc,SAASJ,iBAAEC,GAAF,CAAMX,IAAN,EAAW,KAAX,CAAf;;AAEA,gBAAMe,gDAA8CD,MAApD;;AAEAE,oBAAQC,GAAR,CAAYR,OAAOG,EAAP,GAAYC,OAAZ,GAAsBC,MAAlC;AACAE,oBAAQC,GAAR,CAAY,qBAAZ;;AAMJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACI,gBAAIC,cAAa;AACbT,sBAAOA,IADM;AAEbG,oBAAKA,EAFQ;AAGbO,yBAAU,qBAHG;AAIbC,sBAAOP,OAJM;AAKbQ,mDAAkCZ,IAAlC,WAA4CI,OAA5C,2BAAyEE,YAAzE,8CAA8HN,IAA9H;AALa,aAAjB;;AAQAP,kBAAMoB,QAAN,CAAeJ,WAAf,EAA2B,UAACK,GAAD,EAAKC,IAAL,EAAY;AACnCR,wBAAQC,GAAR,CAAY,gCAAZ,EAA6CM,GAA7C,EAAiDC,IAAjD;AACA,uBAAOvB,SAASsB,GAAT,EAAaC,IAAb,CAAP;AACH,aAHD;AAIH;;;;;;kBAxFgB1B,K","file":"email.js","sourcesContent":["import _ from 'lodash'\r\nimport url from './config'\r\nimport smtp from './config'\r\nimport nodemailer from 'nodemailer'\r\nexport default class Email {\r\n\r\n    constructor(app)    {\r\n        this.app = app;\r\n\r\n    }\r\n\r\n\r\n    sendDownloadLink(post, callback=()=>{}){\r\n\r\n\r\n//         var nodemailer = require('nodemailer');\r\n\r\n    var email = nodemailer.createTransport({\r\n    // host: 'smtp.sendgrid.net',\r\n  //  host: 'mail.traversymedia.com',\r\n   \r\n    // port: 587,\r\n    // secure: false, \r\n    service :'gmail',\r\n      \r\n    auth: {\r\n      \r\n      user: 'ramyas2898@gmail.com', // generated ethereal user\r\n      pass: 'googlechrome!'\r\n\r\n        // user: 'apikey', // generated ethereal user\r\n        // pass: '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'  // generated ethereal password\r\n\r\n    },\r\n    // proxy: 'http://proxy-host:1234',\r\n\r\n    // tls:{\r\n    //     rejectUnauthorized:false\r\n    // }\r\n});\r\n\r\n        // let email = nodemailer.createTransport(smtp);\r\n\r\n        const from = _.get(post,'from');\r\n        const to = _.get(post,'to');\r\n        const message = _.get(post,'message', '');\r\n        const postId = _.get(post,'_id');\r\n        \r\n        const downloadLink = `http://localhost:3006/share/${postId}`\r\n        \r\n        console.log(from + to + message + postId);\r\n        console.log(\"inside senddownload\");\r\n\r\n\r\n\r\n        \r\n\r\n    // var helper = require('sendgrid').mail;\r\n    // var fromEmail = new helper.Email(from);\r\n    // var toEmail = new helper.Email(to);\r\n    // var subject = 'Sending with SendGrid is Fun';\r\n    // var content = new helper.Content('text/plain', 'and easy to do anywhere, even with Node.js');\r\n    // var mail = new helper.Mail(fromEmail, subject, toEmail, content);\r\n     \r\n    // var sg = require('sendgrid')(process.env.SENDGRID_API_KEY);\r\n    // var request = sg.emptyRequest({\r\n    //   method: 'POST',\r\n    //   path: '/v3/mail/send',\r\n    //   body: mail.toJSON()\r\n    // });\r\n     \r\n    // sg.API(request, function (error, response) {\r\n    //   if (error) {\r\n    //     console.log('Error response received');\r\n    //   }\r\n    //   console.log(response.statusCode);\r\n    //   console.log(response.body);\r\n    //   console.log(response.headers);\r\n    //   return callback(error,response);\r\n    // });\r\n        let mailOptions ={\r\n            from : from ,\r\n            to : to,\r\n            subject : 'Download invitation',\r\n            text : message,\r\n            html : `<p>Hiiii!  Message from ${from} : ${message}  Click <a href = \"${downloadLink}\"> here to download the files sent by ${from}.  </p>`\r\n        }\r\n\r\n        email.sendMail(mailOptions,(err,info)=>{\r\n            console.log(\"sending an email with callback\",err,info);\r\n            return callback(err,info);\r\n        })\r\n    }\r\n}"]}